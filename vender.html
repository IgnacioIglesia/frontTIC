<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vender ‚Äî La Otra Tribuna</title>
  <link rel="stylesheet" href="styles/main.css" />
  <link rel="stylesheet" href="styles/vender.css" />
  <link rel="icon" type="image/png" href="./assets/logo.png" />
</head>
<body>
  <!-- ===== HEADER ===== -->
  <header id="siteHeader">
    <div class="top container">
      <div class="brand-wrap">
        <a href="index.html" class="logo-link" aria-label="Ir al inicio">
          <img class="logo" src="./assets/logo.png" alt="La Otra Tribuna" />
        </a>
      </div>

      <div class="search">
        <input id="q" type="search" placeholder="Buscar club o pa√≠s‚Ä¶" autocomplete="off" />
        <div id="searchMenu" class="search-menu" hidden></div>
      </div>

      <div class="header-messages">Public√° tu camiseta en segundos</div>

      <div class="actions">
        <a href="login.html" class="btn-login">Iniciar sesi√≥n</a>
        <button class="pill" id="favBtn" aria-label="Favoritos">‚ù§Ô∏è<span id="favCount">0</span></button>
        <button class="pill" id="cartBtn" aria-label="Carrito">üõí <span id="cartCount">0</span></button>
      </div>
    </div>

    <!-- ===== SUBNAV ===== -->
    <nav class="subnav">
      <div class="container subnav-inner">
        <div class="subnav-left">
          <a href="#ubicacion" class="loc-link" id="openLocation">
            <svg class="loc-ic" width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M12 22s7-6.46 7-12a7 7 0 1 0-14 0c0 5.54 7 12 7 12Z" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
              <circle cx="12" cy="10" r="2.5" stroke="currentColor" stroke-width="1.6"/>
            </svg>
            <span class="loc-line" id="locText">Ingresa tu <strong>ubicaci√≥n</strong></span>
          </a>
        </div>

        <div class="subnav-center">
          <a href="index.html#categorias" class="subnav-link">Categor√≠as</a>
          <a href="index.html#ofertas" class="subnav-link">Ofertas</a>
          <a href="vender.html" class="subnav-link active">Vender</a>
          <a href="rastrear.html" class="subnav-link">Rastrear Pedido</a>
        </div>

        <div class="subnav-right">
          <a href="ayuda.html" class="subnav-link">Ayuda</a>
        </div>
      </div>
    </nav>
  </header>

  <!-- ===== OVERLAY ===== -->
  <div id="overlay" class="overlay"></div>

  <!-- ===== MODAL UBICACI√ìN (igual a rastrear) ===== -->
  <div id="locationModal" class="modal" aria-hidden="true" role="dialog" aria-labelledby="locTitle" aria-modal="true">
    <div class="modal-card">
      <div class="modal-head">
        <h3 id="locTitle">Elige d√≥nde recibir tus compras</h3>
        <button class="modal-close" id="closeLocation" aria-label="Cerrar">‚úï</button>
      </div>
      <p class="muted" style="margin:0 0 12px">Podr√°s ver costos y tiempos de entrega precisos en todo lo que busques.</p>

      <form id="locForm" class="loc-form" autocomplete="off">
        <div class="field">
          <label for="departamento">Departamento</label>
          <select id="departamento" required>
            <option value="" selected>Elija una opci√≥n</option>
          </select>
        </div>
        <div class="field">
          <label for="localidad">Localidad</label>
          <select id="localidad" required disabled>
            <option value="" selected>Elija una opci√≥n</option>
          </select>
        </div>
        <div class="actions-row">
          <button type="button" class="btn" id="cancelLoc">Cancelar</button>
          <button type="submit" class="btn primary" id="acceptLoc" disabled>Aceptar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- ===== CONTENIDO ===== -->
  <main class="track-full">
    <div class="track-card sell-card">
      <div class="track-title">
        <img src="./assets/imagen.png" alt="" style="width:40px;height:40px;border-radius:8px;">
        <h2 style="margin:0;font-size:22px">Vender</h2>
      </div>

      <form class="track-form" id="sellForm">
        <div class="form-grid two-cols">
          <!-- Imagen -->
          <div class="field span-2">
            <label>Imagen de la publicaci√≥n</label>
            <div class="image-field">
              <div class="image-drop" id="dropArea">
                <input type="file" id="imagen" accept="image/*" hidden>
                <img id="preview" alt="">
                <label for="imagen" class="btn">Subir imagen</label>
              </div>
              <p class="helper muted">Sub√≠ una foto clara de la camiseta. Solo se admite 1 imagen por ahora.</p>
            </div>
          </div>
      
          <!-- T√≠tulo -->
          <div class="field span-2">
            <label for="titulo">T√≠tulo</label>
            <input id="titulo" type="text" placeholder="Ej: Camiseta Barcelona 24/25" required>
          </div>
      
          <!-- Descripci√≥n -->
          <div class="field span-2">
            <label for="descripcion">Descripci√≥n</label>
            <textarea id="descripcion" placeholder="Detalles sobre la camiseta‚Ä¶" required></textarea>
          </div>
      
          <!-- Precio y Moneda -->
          <div class="field">
            <label for="precio">Precio</label>
            <input id="precio" type="number" placeholder="Ej: 3500" required>
          </div>
          <div class="field">
            <label for="moneda">Moneda</label>
            <select id="moneda" required>
              <option value="UYU">UYU</option>
              <option value="USD">USD</option>
            </select>
          </div>
      
          <!-- Condici√≥n y Autenticidad -->
          <div class="field">
            <label for="condicion">Condici√≥n</label>
            <select id="condicion" required>
              <option value="Nuevo">Nuevo</option>
              <option value="Usado">Usado</option>
            </select>
          </div>
          <div class="field">
            <label for="auth">Autenticidad</label>
            <select id="auth" required>
              <option value="Original">Original</option>
              <option value="Replica">R√©plica</option>
            </select>
          </div>
      
          <!-- Talle y Stock -->
          <div class="field">
            <label for="talle">Talle</label>
            <select id="talle" required>
              <option>XS</option><option>S</option><option>M</option>
              <option>L</option><option>XL</option><option>XXL</option><option>XXXL</option>
            </select>
          </div>
          <div class="field">
            <label for="stock">Stock</label>
            <input id="stock" type="number" min="0" placeholder="Ej: 10" required>
          </div>
      
          <!-- Categor√≠a (segmented correcto) -->
          <div class="field span-2">
            <label>Categor√≠a de la publicaci√≥n</label>
            <div class="segmented">
              <input type="radio" id="categoria-club" name="categoria" value="Club" checked>
              <label for="categoria-club">Club</label>
      
              <input type="radio" id="categoria-seleccion" name="categoria" value="Selecci√≥n">
              <label for="categoria-seleccion">Selecci√≥n</label>
      
              <input type="radio" id="categoria-retro" name="categoria" value="Retro">
              <label for="categoria-retro">Retro</label>
            </div>
          </div>
      
          <!-- Estado (segmented) -->
          <div class="field span-2">
            <label>Estado de la publicaci√≥n</label>
            <div class="segmented">
              <input type="radio" id="estado-activa" name="estado" value="Activa" checked>
              <label for="estado-activa">Activa</label>
      
              <input type="radio" id="estado-conv" name="estado" value="En conversaci√≥n">
              <label for="estado-conv">En conversaci√≥n</label>
      
              <input type="radio" id="estado-vendida" name="estado" value="Vendida">
              <label for="estado-vendida">Vendida</label>
            </div>
          </div>
        </div>
      
        <!-- Bot√≥n centrado y dentro del form -->
        <button type="submit" class="btn primary submit-full">Publicar</button>
      </form>
    </div>
  </main>

  <footer class="site-footer">¬© <span id="year"></span> La Otra Tribuna.</footer>

  <!-- ===== SCRIPTS ===== -->
  <!-- Lista de departamentos/localidades (igual que rastrear). Debe definir window.UY_DEPTS -->
  <script src="scripts/uy-depts.js"></script>

  <script>
    // A√±o + sombra header
    document.getElementById('year').textContent = new Date().getFullYear();
    const siteHeader = document.getElementById('siteHeader');
    function onScroll(){ siteHeader.classList.toggle('is-scrolled', window.scrollY > 0); }
    onScroll(); window.addEventListener('scroll', onScroll, {passive:true});

    // ===== Ubicaci√≥n (id√©ntico a rastrear) =====
    const LOCATION_KEY = 'lot_location';
    const overlay = document.getElementById('overlay');
    const locationModal = document.getElementById('locationModal');
    const openLocationBtn = document.getElementById('openLocation');
    const closeLocationBtn = document.getElementById('closeLocation');
    const cancelLocBtn = document.getElementById('cancelLoc');
    const deptSel = document.getElementById('departamento');
    const locSel  = document.getElementById('localidad');
    const acceptLocBtn = document.getElementById('acceptLoc');
    const locText = document.getElementById('locText');

    const DEPTS = {"Artigas": [
        "Artigas", "Bella Uni√≥n", "Tom√°s Gomensoro", "Baltasar Brum"
      ],
      "Canelones": [
        "Canelones", "Ciudad de la Costa", "Las Piedras", "Pando", "La Paz",
        "Progreso", "Santa Luc√≠a", "Atl√°ntida", "Parque del Plata", "Sauce",
        "San Ram√≥n", "Empalme Olmos", "Toledo"
      ],
      "Cerro Largo": [
        "Melo", "R√≠o Branco", "Fraile Muerto", "Tupamba√©", "Isidoro Nobl√≠a"
      ],
      "Colonia": [
        "Colonia del Sacramento", "Carmelo", "Nueva Helvecia", "Juan Lacaze",
        "Rosario", "Tarariras", "Omb√∫es de Lavalle"
      ],
      "Durazno": [
        "Durazno", "Sarand√≠ del Y√≠", "Carmen", "Centenario"
      ],
      "Flores": [
        "Trinidad", "Ismael Cortinas"
      ],
      "Florida": [
        "Florida", "Sarand√≠ Grande", "Casup√°", "25 de Mayo"
      ],
      "Lavalleja": [
        "Minas", "Jos√© Pedro Varela", "Sol√≠s de Mataojo", "Mariscala"
      ],
      "Maldonado": [
        "Maldonado", "Punta del Este", "San Carlos", "Piri√°polis",
        "Pan de Az√∫car", "Aigu√°", "La Barra"
      ],
      "Montevideo": [
        "Montevideo" // se maneja por barrios normalmente
      ],
      "Paysand√∫": [
        "Paysand√∫", "Guich√≥n", "Quebracho", "Piedras Coloradas"
      ],
      "R√≠o Negro": [
        "Fray Bentos", "Young", "Nuevo Berl√≠n", "San Javier"
      ],
      "Rivera": [
        "Rivera", "Tranqueras", "Minas de Corrales", "Vichadero", "Mandub√≠"
      ],
      "Rocha": [
        "Rocha", "Chuy", "Castillos", "Lascano", "La Paloma", "Punta del Diablo"
      ],
      "Salto": [
        "Salto", "Constituci√≥n", "Bel√©n", "Daym√°n", "San Antonio"
      ],
      "San Jos√©": [
        "San Jos√© de Mayo", "Ciudad del Plata", "Libertad", "Ecilda Paullier",
        "Delta El Tigre", "Raig√≥n"
      ],
      "Soriano": [
        "Mercedes", "Dolores", "Cardona", "Jos√© Enrique Rod√≥", "Palmitas"
      ],
      "Tacuaremb√≥": [
        "Tacuaremb√≥", "Paso de los Toros", "San Gregorio de Polanco",
        "Curtina", "Ansina"
      ],
      "Treinta y Tres": [
        "Treinta y Tres", "Vergara", "Santa Clara de Olimar", "Villa Sara"
      ]};

    function renderLocationText(){
      const raw = localStorage.getItem(LOCATION_KEY);
      if(!raw){ locText.innerHTML = 'Ingresa tu <strong>ubicaci√≥n</strong>'; return; }
      try{ const {loc} = JSON.parse(raw); locText.textContent = `Enviar a ${loc}`; }
      catch{ locText.innerHTML = 'Ingresa tu <strong>ubicaci√≥n</strong>'; }
    }
    function fillDept(){ Object.keys(DEPTS).forEach(d => deptSel.append(new Option(d,d))); }

    function showOverlay(){ overlay.classList.add('show'); }
    function hideOverlay(){ overlay.classList.remove('show'); }
    function openLocation(){ locationModal.classList.add('open'); showOverlay(); }
    function closeLocation(){ locationModal.classList.remove('open'); hideOverlay(); }

    openLocationBtn.addEventListener('click', (e)=>{ e.preventDefault(); openLocation(); });
    closeLocationBtn.addEventListener('click', closeLocation);
    cancelLocBtn.addEventListener('click', closeLocation);
    overlay.addEventListener('click', closeLocation);

    deptSel.addEventListener('change', ()=>{
      const dept = deptSel.value;
      locSel.innerHTML = '<option value="" selected>Elija una opci√≥n</option>';
      if(!dept){ locSel.disabled = true; acceptLocBtn.disabled = true; return; }
      (DEPTS[dept] || []).forEach(l => locSel.append(new Option(l,l)));
      locSel.disabled = false; acceptLocBtn.disabled = true;
    });
    locSel.addEventListener('change', ()=> acceptLocBtn.disabled = !locSel.value);

    document.getElementById('locForm').addEventListener('submit', (e)=>{
      e.preventDefault();
      if(!deptSel.value || !locSel.value) return;
      localStorage.setItem(LOCATION_KEY, JSON.stringify({dept:deptSel.value, loc:locSel.value}));
      renderLocationText(); closeLocation();
    });

    fillDept(); renderLocationText();

    // ===== Imagen: vista previa + drag & drop =====
    const fileInput = document.getElementById('imagen');
    const preview   = document.getElementById('preview');
    const dropArea  = document.getElementById('dropArea');

    fileInput.addEventListener('change', e => {
      const file = e.target.files?.[0]; if(!file) return;
      const reader = new FileReader();
      reader.onload = ev => { preview.src = ev.target.result; preview.style.display = 'block'; };
      reader.readAsDataURL(file);
    });
    ['dragenter','dragover'].forEach(evt =>
      dropArea.addEventListener(evt, e => { e.preventDefault(); dropArea.classList.add('drag'); })
    );
    ['dragleave','drop'].forEach(evt =>
      dropArea.addEventListener(evt, e => { e.preventDefault(); dropArea.classList.remove('drag'); })
    );
    dropArea.addEventListener('drop', e => {
      const f = e.dataTransfer.files && e.dataTransfer.files[0];
      if(f){ fileInput.files = e.dataTransfer.files; fileInput.dispatchEvent(new Event('change')); }
    });
  </script>
</body>
</html>