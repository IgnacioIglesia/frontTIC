<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rastrear Pedido — La Otra Tribuna</title>
  <link rel="stylesheet" href="styles/main.css">
  <link rel="icon" type="image/png" href="./assets/logo.png">
</head>
<body>
  <!-- ===== HEADER ===== -->
  <header id="siteHeader">
    <div class="top container">
      <div class="brand-wrap">
        <a href="index.html" class="logo-link" aria-label="Ir al inicio">
          <img class="logo" src="./assets/logo.png" alt="La Otra Tribuna">
        </a>
      </div>

      <div class="search">
        <input id="q" type="search" placeholder="Buscar club o país…" autocomplete="off" />
        <div id="searchMenu" class="search-menu" hidden></div>
      </div>

      <div class="header-messages">Envíos seguros y rápidos</div>

      <div class="actions">
        <a href="login.html" class="btn-login">Iniciar sesión</a>
      </div>
    </div>

    <nav class="subnav">
      <div class="container subnav-inner">
        <div class="subnav-left">
          <!-- botón/estado de ubicación -->
          <a href="#ubicacion" class="loc-link" id="openLocation">
            <svg class="loc-ic" width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M12 22s7-6.46 7-12a7 7 0 1 0-14 0c0 5.54 7 12 7 12Z" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
              <circle cx="12" cy="10" r="2.5" stroke="currentColor" stroke-width="1.6"/>
            </svg>
            <span class="loc-line" id="locText">Enviar a <strong>Montevideo</strong></span>
          </a>
        </div>
    
        <div class="subnav-center">
          <div class="has-submenu" id="catsDrop">
            <a href="index.html" class="subnav-link" id="catsLink" aria-haspopup="true" aria-expanded="false">
              Categorías <span class="chev" aria-hidden="true">▾</span>
            </a>
            <div class="cat-submenu" id="catsMenu" role="menu" aria-label="Categorías">
              <a href="index.html?cat=club#catalogo">Club</a>
              <a href="index.html?cat=seleccion#catalogo">Selección</a>
              <a href="index.html?cat=retro#catalogo">Retro</a>
            </div>
          </div>
          <a href="ofertas.html" class="subnav-link">Ofertas</a>
          <a href="vender.html" class="subnav-link">Vender</a>
          <a href="rastrear.html" class="subnav-link">Rastrear Pedido</a>
        </div>
    
        <div class="subnav-right">
          <a href="favoritos.html" class="subnav-link">Favoritos</a>
          <a href="como-funciona.html" class="subnav-link">Cómo funciona</a>
          <a href="Autenticidad.html" class="subnav-link">Autenticidad</a>
          <a href="ayuda.html" class="subnav-link">Ayuda</a>
        </div>
      </div>
    </nav>
  </header>

  <!-- ===== OVERLAY ===== -->
  <div id="overlay" class="overlay"></div>

  <!-- ===== MODAL UBICACIÓN ===== -->
  <div id="locationModal" class="modal">
    <div class="modal-card">
      <div class="modal-head">
        <h3>Elige dónde recibir tus compras</h3>
        <button class="modal-close" id="closeLocation">✕</button>
      </div>
      <form id="locForm" class="loc-form">
        <div class="field">
          <label for="departamento">Departamento</label>
          <select id="departamento" required>
            <option value="" selected>Elija una opción</option>
          </select>
        </div>
        <div class="field">
          <label for="localidad">Localidad</label>
          <select id="localidad" required disabled>
            <option value="" selected>Elija una opción</option>
          </select>
        </div>
        <div class="actions-row">
          <button type="button" class="btn" id="cancelLoc">Cancelar</button>
          <button type="submit" class="btn primary" id="acceptLoc" disabled>Aceptar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- ===== CONTENIDO ===== -->
  <main class="track-full">
    <div class="track-card">
      <div class="track-title">
        <img src="./assets/imagen.png" alt="" style="width:40px; height:40px; border-radius:8px;">
        <h2 style="margin:0; font-size:22px">Rastrear Pedido</h2>
      </div>

      <form id="trackForm" class="track-form">
        <div class="field">
          <label for="tracking">Número de seguimiento</label>
          <input id="tracking" type="text" placeholder="Ej: ABC123456UY" required>
        </div>
        <button class="btn primary" type="submit">Rastrear</button>
      </form>

      <div id="trackResult" class="track-result" hidden>
        <h3>Resultado</h3>
        <p id="trackResultText" class="muted"></p>
      </div>
    </div>
  </main>

  <footer class="site-footer">© <span id="year"></span> La Otra Tribuna.</footer>

  <script>
    // ===== Footer dinámico
    document.getElementById('year').textContent = new Date().getFullYear();

    // ===== LocalStorage Ubicación (reutiliza lo del index)
    const LOCATION_KEY = 'lot_location';
    const locText = document.getElementById('locText');
    const deptSel = document.getElementById('departamento');
    const locSel = document.getElementById('localidad');
    const acceptLocBtn = document.getElementById('acceptLoc');
    const overlay = document.getElementById('overlay');
    const locationModal = document.getElementById('locationModal');

    const DEPTS = {
      "Artigas": [
        "Artigas", "Bella Unión", "Tomás Gomensoro", "Baltasar Brum"
      ],
      "Canelones": [
        "Canelones", "Ciudad de la Costa", "Las Piedras", "Pando", "La Paz",
        "Progreso", "Santa Lucía", "Atlántida", "Parque del Plata", "Sauce",
        "San Ramón", "Empalme Olmos", "Toledo"
      ],
      "Cerro Largo": [
        "Melo", "Río Branco", "Fraile Muerto", "Tupambaé", "Isidoro Noblía"
      ],
      "Colonia": [
        "Colonia del Sacramento", "Carmelo", "Nueva Helvecia", "Juan Lacaze",
        "Rosario", "Tarariras", "Ombúes de Lavalle"
      ],
      "Durazno": [
        "Durazno", "Sarandí del Yí", "Carmen", "Centenario"
      ],
      "Flores": [
        "Trinidad", "Ismael Cortinas"
      ],
      "Florida": [
        "Florida", "Sarandí Grande", "Casupá", "25 de Mayo"
      ],
      "Lavalleja": [
        "Minas", "José Pedro Varela", "Solís de Mataojo", "Mariscala"
      ],
      "Maldonado": [
        "Maldonado", "Punta del Este", "San Carlos", "Piriápolis",
        "Pan de Azúcar", "Aiguá", "La Barra"
      ],
      "Montevideo": [
        "Montevideo" // se maneja por barrios normalmente
      ],
      "Paysandú": [
        "Paysandú", "Guichón", "Quebracho", "Piedras Coloradas"
      ],
      "Río Negro": [
        "Fray Bentos", "Young", "Nuevo Berlín", "San Javier"
      ],
      "Rivera": [
        "Rivera", "Tranqueras", "Minas de Corrales", "Vichadero", "Mandubí"
      ],
      "Rocha": [
        "Rocha", "Chuy", "Castillos", "Lascano", "La Paloma", "Punta del Diablo"
      ],
      "Salto": [
        "Salto", "Constitución", "Belén", "Daymán", "San Antonio"
      ],
      "San José": [
        "San José de Mayo", "Ciudad del Plata", "Libertad", "Ecilda Paullier",
        "Delta El Tigre", "Raigón"
      ],
      "Soriano": [
        "Mercedes", "Dolores", "Cardona", "José Enrique Rodó", "Palmitas"
      ],
      "Tacuarembó": [
        "Tacuarembó", "Paso de los Toros", "San Gregorio de Polanco",
        "Curtina", "Ansina"
      ],
      "Treinta y Tres": [
        "Treinta y Tres", "Vergara", "Santa Clara de Olimar", "Villa Sara"
      ]
    };

    function fillDept(){ Object.keys(DEPTS).forEach(d => deptSel.append(new Option(d,d))); }
    function renderLocationText(){
      const raw = localStorage.getItem(LOCATION_KEY);
      if(!raw){ locText.innerHTML = 'Ingresa tu <strong>ubicación</strong>'; return; }
      try{ const {loc} = JSON.parse(raw); locText.textContent = `Enviar a ${loc}`; }
      catch{ locText.innerHTML = 'Ingresa tu <strong>ubicación</strong>'; }
    }

    document.getElementById('openLocation').addEventListener('click', e=>{
      e.preventDefault(); locationModal.classList.add('open'); overlay.classList.add('show');
    });
    document.getElementById('closeLocation').addEventListener('click', ()=>{
      locationModal.classList.remove('open'); overlay.classList.remove('show');
    });
    document.getElementById('cancelLoc').addEventListener('click', ()=>{
      locationModal.classList.remove('open'); overlay.classList.remove('show');
    });
    overlay.addEventListener('click', ()=>{
      locationModal.classList.remove('open'); overlay.classList.remove('show');
    });

    deptSel.addEventListener('change', ()=>{
      locSel.innerHTML = '<option value="">Elija una opción</option>';
      if(!deptSel.value){ locSel.disabled = true; acceptLocBtn.disabled = true; return; }
      DEPTS[deptSel.value].forEach(l => locSel.append(new Option(l,l)));
      locSel.disabled = false; acceptLocBtn.disabled = true;
    });
    locSel.addEventListener('change', ()=>{ acceptLocBtn.disabled = !locSel.value; });

    document.getElementById('locForm').addEventListener('submit', e=>{
      e.preventDefault();
      localStorage.setItem(LOCATION_KEY, JSON.stringify({dept:deptSel.value, loc:locSel.value}));
      renderLocationText();
      locationModal.classList.remove('open'); overlay.classList.remove('show');
    });

    fillDept(); renderLocationText();

    // ===== Rastrear Pedido (simulado)
    document.getElementById('trackForm').addEventListener('submit', e=>{
      e.preventDefault();
      const code = document.getElementById('tracking').value.trim();
      if(!code) return;
      document.getElementById('trackResultText').textContent = `Seguimiento del pedido ${code} (demo)`;
      document.getElementById('trackResult').hidden = false;
    });
  </script>
</body>
</html>